# 工作流导航

> 定义复杂任务的阶段流转和 AI 协作方式。

## 阶段模型

```
触发请求 → 任务路由 → 阶段执行 → 验证 → 下一阶段/完成
```

### 阶段定义

| 阶段 | 触发条件 | 产出物 |
|------|---------|--------|
| [proposal](phases/proposal.md) | 新功能、重大变更 | 提案文档 |
| [design](phases/design.md) | 需要技术设计 | 设计文档 |
| [implement](phases/implement.md) | 设计完成或简单任务 | 代码变更 |
| [review](phases/review.md) | 实现完成 | 审查报告 |

### 阶段流转图

```
┌──────────┐
│  触发请求  │
└────┬─────┘
     │
     ▼
┌──────────┐    复杂任务    ┌──────────┐
│ 任务路由  │──────────────→│  提案阶段  │
└────┬─────┘               └────┬─────┘
     │                          │
     │ 简单任务                   ▼
     │                    ┌──────────┐
     │                    │  设计阶段  │(可选)
     │                    └────┬─────┘
     │                          │
     ▼                          ▼
┌──────────┐               ┌──────────┐
│  实现阶段  │←──────────────│          │
└────┬─────┘               └──────────┘
     │
     ▼
┌──────────┐
│  审查阶段  │
└────┬─────┘
     │
     ▼
┌──────────┐
│   完成    │
└──────────┘
```

## 任务路由规则

AI 接收任务时，根据以下规则判断流程：

### 需要提案的任务

- 新功能或新能力
- 破坏性变更（API、数据库 schema）
- 架构调整
- 性能优化（改变行为）
- 安全模式变更

### 直接实现的任务

- Bug 修复（恢复预期行为）
- 代码重构（不改变行为）
- 文档更新
- 配置变更
- 依赖更新（非破坏性）

### 需要设计的任务

- 跨模块/跨服务变更
- 新增外部依赖
- 数据模型变更
- 有安全/性能考虑

## 阶段文档

- [提案阶段](phases/proposal.md) - 创建和审核变更提案
- [设计阶段](phases/design.md) - 技术设计和决策
- [实现阶段](phases/implement.md) - 代码编写和测试
- [审查阶段](phases/review.md) - 代码审查和验收

## 与 OpenSpec 集成

如果项目使用 OpenSpec 进行规范驱动开发：

1. **提案阶段**对应 OpenSpec 的 `changes/` 目录
2. **设计阶段**对应 `design.md` 文件
3. 参阅 `openspec/AGENTS.md` 获取详细流程
