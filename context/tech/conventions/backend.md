# 后端开发规范

> 后端代码的编写规范和最佳实践。

## 代码组织

<!-- 根据项目技术栈调整 -->

### 目录结构

```
src/
├── [layer1]/      # [层级1描述]
├── [layer2]/      # [层级2描述]
└── [layer3]/      # [层级3描述]
```

### 命名规范

| 类型 | 规范 | 示例 |
|------|------|------|
| 类名 | PascalCase | `UserService` |
| 方法名 | camelCase | `createUser()` |
| 常量 | UPPER_SNAKE_CASE | `MAX_RETRY_COUNT` |
| 包/模块 | lowercase | `user.service` |

## 编码规范

### 错误处理

```[language]
// 正确示例
[示例代码]

// 错误示例
[反例代码]
```

### 日志规范

| 级别 | 使用场景 | 示例 |
|------|---------|------|
| ERROR | 系统错误、需要人工介入 | 数据库连接失败 |
| WARN | 潜在问题、可自动恢复 | 重试成功 |
| INFO | 重要业务事件 | 用户登录 |
| DEBUG | 开发调试信息 | 方法入参 |

### 注释规范

- 公共 API 必须有文档注释
- 复杂逻辑需要解释「为什么」而非「做什么」
- 避免过时的注释

## 测试规范

### 单元测试

- 测试文件命名：`[ClassName]Test.[ext]`
- 测试方法命名：`should_[期望行为]_when_[条件]`
- 每个测试只验证一个行为

### 测试覆盖率

| 层级 | 最低覆盖率 |
|------|-----------|
| 领域层 | 90% |
| 应用层 | 80% |
| 接口层 | 70% |

## API 设计

### RESTful 规范

| 操作 | HTTP 方法 | URL 模式 | 示例 |
|------|----------|---------|------|
| 列表 | GET | `/resources` | `GET /users` |
| 详情 | GET | `/resources/{id}` | `GET /users/123` |
| 创建 | POST | `/resources` | `POST /users` |
| 更新 | PUT | `/resources/{id}` | `PUT /users/123` |
| 删除 | DELETE | `/resources/{id}` | `DELETE /users/123` |

### 响应格式

```json
{
  "code": 0,
  "message": "success",
  "data": { ... }
}
```

## 常见反模式

| 反模式 | 问题 | 正确做法 |
|--------|------|---------|
| 贫血模型 | 业务逻辑散落在 Service | 把业务逻辑放在领域模型 |
| 上帝类 | 单个类职责过多 | 拆分为多个职责单一的类 |
| N+1 查询 | 循环中查询数据库 | 批量查询 |
